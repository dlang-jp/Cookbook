
<!DOCTYPE html>
<html>    <head>        <meta name="viewport" content="width=device-width,initial-scale=1">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <link rel="stylesheet" type="text/css" href="css/proj_docs.css">
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script type="text/javascript" src="js/sidebar.js"></script>
        <script type="text/javascript" src="js/listanchors.js"></script>
        <title>hash_example - D言語クックブック</title>
        
        
    </head>
    <body>        
        <div class="container">            
<div class="sidebar-underbar"></div>
<div class="sidebar">    <div class="head">        <a class='githublinkimg' href="https://github.com/dlang-jp/Cookbook"><img src="img/GitHub-Mark-32px.png" width="32" height="32" /></a>
        <h2>D言語クックブック</h2>
        <p><span class="smallprint"><b>version:</b> ~master <span class="separator"><br></span>
            </span>
        </p>
        <p><a href="index.html">overview</a></p>
    </div>
    
    <ul>

	

	<li><a href="cookbook--array_example.html"><span >配列</span></a></li>



	<li><a href="cookbook--assoc_array_example.html"><span >連想配列</span></a></li>



	<li><a href="cookbook--concurrency_example.html"><span >並行処理</span></a></li>



	<li><a href="cookbook--container_example.html"><span >コンテナ</span></a></li>


	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >データ形式
		</span></a><ul><li><a href="
			cookbook--data.html"><span >overview</span></a></li>
			

	<li><a href="cookbook--data.base64_example.html"><span >Base64エンコード/デコード</span></a></li>



	<li><a href="cookbook--data.csv_example.html"><span >CSV操作</span></a></li>



	<li><a href="cookbook--data.json_example.html"><span >JSON操作</span></a></li>



	<li><a href="cookbook--data.zip_example.html"><span >ZIP操作</span></a></li>

</ul></li>
	
	





	<li><a href="cookbook--datetime_example.html"><span >時刻・日付</span></a></li>



	<li><a href="cookbook--exception_example.html"><span >例外</span></a></li>



	<li><a href="cookbook--file_example.html"><span >ファイルシステム</span></a></li>



	<li><a href="cookbook--gc_example.html"><span >ガベージコレクション</span></a></li>



	<li><a href="cookbook--getopt_example.html"><span >コマンドライン解析</span></a></li>



	<li><a href="cookbook--hash_example.html"><span >ハッシュ値の計算</span></a></li>



	<li><a href="cookbook--is_example.html"><span >is式</span></a></li>



	<li><a href="cookbook--meta_example.html"><span >メタプログラミング</span></a></li>



	<li><a href="cookbook--network_example.html"><span >ネットワーク(cURL)</span></a></li>



	<li><a href="cookbook--numeric_example.html"><span >数値計算</span></a></li>



	<li><a href="cookbook--opovl_excample.html"><span >演算子オーバーロード</span></a></li>



	<li><a href="cookbook--parallelism_example.html"><span >並列処理</span></a></li>



	<li><a href="cookbook--process_example.html"><span >プロセス</span></a></li>



	<li><a href="cookbook--random_example.html"><span >乱数</span></a></li>



	<li><a href="cookbook--range_example.html"><span >レンジ</span></a></li>



	<li><a href="cookbook--regex_example.html"><span >正規表現</span></a></li>



	<li><a href="cookbook--string_example.html"><span >文字列</span></a></li>



	<li><a href="cookbook--sumtype_example.html"><span >SumTypeの例</span></a></li>



	<li><a href="cookbook--sync_example.html"><span >同期機構/排他処理</span></a></li>



	<li><a href="cookbook--template_example.html"><span >テンプレート</span></a></li>



	<li><a href="cookbook--typecons_example.html"><span >型を作るユーティリティ</span></a></li>



	<li><a href="cookbook--uda_example.html"><span >UDA(User Defined Attribute)</span></a></li>



	<li><a href="cookbook--unittests_example.html"><span >単体テスト</span></a></li>





	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >subpkg</span></a><ul>
			

	<li><a href="cookbook-subpkg--subpkg.test.html"><span >サブパッケージの作り方</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >windows</span></a><ul>
			

	<li><a href="cookbook-windows--windows.basic.html"><span >Win32API</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >posix</span></a><ul>
			

	<li><a href="cookbook-posix--posix.basic.html"><span >POSIX</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >linux</span></a><ul>
			

	<li><a href="cookbook-linux--linux.basic.html"><span >Linux</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >libdparse_usage</span></a><ul>
			

	<li><a href="cookbook-libdparse_usage--libdparse_usage.example.html"><span >libdparse</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >asdf_usage</span></a><ul>
			

	<li><a href="cookbook-asdf_usage--asdf_usage.example.html"><span >Asdfの使用例</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >vibed_usage</span></a><ul>
			

	<li><a href="cookbook-vibe-d_usage--vibed_usage.auth.html"><span >認証・権限</span></a></li>



	<li><a href="cookbook-vibe-d_usage--vibed_usage.http.html"><span >HTTPサーバー</span></a></li>



	<li><a href="cookbook-vibe-d_usage--vibed_usage.https.html"><span >HTTPSサーバー</span></a></li>



	<li><a href="cookbook-vibe-d_usage--vibed_usage.rest.html"><span >RESTインターフェースの利用</span></a></li>



	<li><a href="cookbook-vibe-d_usage--vibed_usage.web.html"><span >Webインターフェースの利用</span></a></li>


		</ul></li>
	




</ul>
</div>
            <div class="content">                
                <div class="quickindex" id="quickindex"></div>
                
                <h1><div class="ddoc_summary">ハッシュ値の計算
</div></h1><div class="ddoc_description"><span class="d_inlinecode donthyphenate notranslate">std.digest</span> の使い方についてまとめます。
<div class="ddoc_blankline"></div>

文字列やバイナリデータに対してハッシュ値（ダイジェスト、チェックサムとも呼ばれる）を求めたり16進数の文字列に変換する手順を整理します。

</div>
<div class="ddoc_section_nonstandard"><span class="ddoc_section_nonstandard_header">Source:</span>
<span class="link_to_source"><a href="https://github.com/dlang-jp/Cookbook/tree/master/source/hash_example.d">https://github.com/dlang-jp/Cookbook/tree/master/source/hash_example.d</a></span></div>
<div class="ddoc_examples"><span class="ddoc_examples_header">Examples:</span>
 様々なデータから <span class="d_inlinecode donthyphenate notranslate">ubyte[N]</span> なハッシュ値を計算する方法
<div class="ddoc_blankline"></div>

アルゴリズム毎に提供される便利関数や <span class="d_inlinecode donthyphenate notranslate">digest</span> 関数を使います。
なおアルゴリズムによって生成されるハッシュ値のサイズは決まっているため、これに応じて戻り値の型も変わります。
<pre class="d_code notranslate"><span class="d_keyword">import</span> std.digest;
<span class="d_keyword">import</span> std.digest.crc;
<span class="d_keyword">import</span> std.digest.md;
<span class="d_keyword">import</span> std.digest.sha;
<span class="d_keyword">import</span> std.digest.murmurhash;
<span class="d_keyword">import</span> std.digest.hmac;

<span class="d_comment">// 基礎的なアルゴリズムでは、`&lt;アルゴリズム名&gt;Of`という名前の簡便なテンプレート関数が利用できます
</span><span class="d_keyword">ubyte</span>[4] result1 = crc32Of(<span class="d_string">"Hello!"</span>);
<span class="d_keyword">ubyte</span>[16] result2 = md5Of(<span class="d_string">"Hello"</span>);
<span class="d_keyword">ubyte</span>[20] result3 = sha1Of(<span class="d_string">"Hello"</span>, <span class="d_string">"world"</span>);
<span class="d_keyword">ubyte</span>[32] result4 = sha256Of(<span class="d_string">"Hello"</span>, <span class="d_string">"world"</span>, <span class="d_string">"!"</span>);

<span class="d_comment">// murmurhashなど、用途に合わせてパラメータを変えるようなアルゴリズムでは`digest`関数を使います
</span><span class="d_keyword">ubyte</span>[4] result5 = digest!(MurmurHash3!32)(<span class="d_string">"Hello"</span>, <span class="d_string">", world!"</span>);

<span class="d_comment">// HMACはシークレット値を持つ機構があり、独自に計算する必要があります。
</span><span class="d_comment">// なおHMACは引数に受け付ける値がバイト列限定（`const(ubyte)[]`）であるため、文字列型は `representation` を通して変換します。
</span><span class="d_comment">// これは単なる `cast(immutable(ubyte)[])`` と同等です。
</span><span class="d_keyword">import</span> std.string: representation;

<span class="d_keyword">immutable</span>(<span class="d_keyword">ubyte</span>)[] data1 = <span class="d_string">"Hello"</span>.representation();
<span class="d_keyword">immutable</span>(<span class="d_keyword">ubyte</span>)[] data2 = <span class="d_string">", world!"</span>.representation();
<span class="d_keyword">immutable</span>(<span class="d_keyword">ubyte</span>)[] secret = <span class="d_string">"mysecret"</span>.representation();
<span class="d_keyword">ubyte</span>[32] hmacResult1 = hmac!SHA256(data1, data2, secret);
<span class="d_keyword">ubyte</span>[32] hmacResult2 = hmac!SHA256(<span class="d_string">"Hello, world!"</span>.representation(), secret);
<span class="d_keyword">assert</span>(hmacResult1 == hmacResult2);
</pre>
</div>
<div class="ddoc_examples"><span class="ddoc_examples_header">Examples:</span>
 求めたハッシュ値(ubyteの静的配列、バイト列)から16進数の文字列(<span class="d_inlinecode donthyphenate notranslate">string</span>)を取得する方法
<div class="ddoc_blankline"></div>

<span class="d_inlinecode donthyphenate notranslate">toHexString</span> を利用します。
その他 <span class="d_inlinecode donthyphenate notranslate">format</span> を使って整形する例については文字列のサンプルを参照してください。
<div class="ddoc_blankline"></div>

<span class="d_inlinecode donthyphenate notranslate">toHexString</span> : <a href="https://dlang.org/phobos/std_digest.html#.toHexString">https://dlang.org/phobos/std_digest.html#.toHexString</a>
<pre class="d_code notranslate"><span class="d_keyword">import</span> std.digest;
<span class="d_keyword">import</span> std.digest.sha;
<span class="d_keyword">import</span> std.digest.hmac;
<span class="d_keyword">import</span> std.string: representation;

<span class="d_comment">// toHexStringは、引数に ubyte[N] を受け取り char[N*2] を返すものと、 ubyte[] を受け取り string を返すものがあります。
</span><span class="d_comment">// stringとするためには戻り値に対してidupプロパティを取るか、引数を可変長配列とするため1度スライスを取ってから渡します。
</span><span class="d_comment">// なお静的に処理できる範囲が多い分、idupのほうが効率的になりやすいです。
</span>string result1 = sha256Of(<span class="d_string">"Hello"</span>, <span class="d_string">"world"</span>, <span class="d_string">"!"</span>).toHexString().idup;
string result2 = hmac!SHA256(<span class="d_string">"Hello, world!"</span>.representation(), <span class="d_string">"mysecret"</span>.representation())[].toHexString();

<span class="d_comment">// toHexStringのテンプレート引数により、16進数の英字が大文字小文字を切り替えられます
</span><span class="d_comment">// 指定しない場合は大文字となっています。
</span><span class="d_comment">// 943a702d06f34599aee1f8da8ef9f7296031d699
</span>string lowerText = sha1Of(<span class="d_string">"Hello, world!"</span>).toHexString!(LetterCase.lower)().idup;
<span class="d_comment">// 943A702D06F34599AEE1F8DA8EF9F7296031D699
</span>string upperText = sha1Of(<span class="d_string">"Hello, world!"</span>).toHexString!(LetterCase.upper)().idup;

<span class="d_keyword">import</span> std.uni: isUpper, isLower;
<span class="d_keyword">import</span> std.algorithm: all;

<span class="d_keyword">assert</span>(lowerText.all!(c =&gt; !isUpper(c)));
<span class="d_keyword">assert</span>(upperText.all!(c =&gt; !isLower(c)));
</pre>
</div>

                
            </div>
        </div>
        
        <script type="text/javascript">jQuery(document).ready(listanchors);</script>
        
        
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
     </body>
</html>