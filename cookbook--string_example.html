
<!DOCTYPE html>
<html>    <head>        <meta name="viewport" content="width=device-width,initial-scale=1">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <link rel="stylesheet" type="text/css" href="css/proj_docs.css">
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script type="text/javascript" src="js/sidebar.js"></script>
        <script type="text/javascript" src="js/listanchors.js"></script>
        <title>string_example</title>
        
        
    </head>
    <body>        
        <div class="container">            
<div class="sidebar-underbar"></div>
<div class="sidebar">    <div class="head">        <h2>cookbook</h2>
        <p><span class="smallprint"><b>version:</b> ~master <span class="separator"><br></span>
            </span>
        </p>
        <p><a href="index.html">overview</a></p>
    </div>
    
    <ul>

	

	<li><a href="cookbook--array_example.html"><span >配列</span></a></li>



	<li><a href="cookbook--assoc_array_example.html"><span >連想配列</span></a></li>



	<li><a href="cookbook--concurrency_example.html"><span >並行処理</span></a></li>



	<li><a href="cookbook--container_example.html"><span >コンテナ</span></a></li>


	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >データ形式
		</span></a><ul><li><a href="
			cookbook--data.html"><span >overview</span></a></li>
			

	<li><a href="cookbook--data.base64_example.html"><span >Base64エンコード/デコード</span></a></li>



	<li><a href="cookbook--data.csv_example.html"><span >CSV操作</span></a></li>



	<li><a href="cookbook--data.json_example.html"><span >JSON操作</span></a></li>



	<li><a href="cookbook--data.zip_example.html"><span >ZIP走査</span></a></li>

</ul></li>
	
	





	<li><a href="cookbook--datetime_example.html"><span >時刻・日付</span></a></li>



	<li><a href="cookbook--exception_example.html"><span >例外</span></a></li>



	<li><a href="cookbook--file_example.html"><span >ファイルシステム</span></a></li>



	<li><a href="cookbook--getopt_example.html"><span >コマンドライン解析</span></a></li>



	<li><a href="cookbook--is_example.html"><span >is式</span></a></li>



	<li><a href="cookbook--meta_example.html"><span >メタプログラミング</span></a></li>



	<li><a href="cookbook--network_example.html"><span >ネットワーク(cURL)</span></a></li>



	<li><a href="cookbook--numeric_example.html"><span >数値計算</span></a></li>



	<li><a href="cookbook--parallelism_example.html"><span >並列処理</span></a></li>



	<li><a href="cookbook--process_example.html"><span >プロセス</span></a></li>



	<li><a href="cookbook--random_example.html"><span >乱数</span></a></li>



	<li><a href="cookbook--range_example.html"><span >レンジ</span></a></li>



	<li><a href="cookbook--regex_example.html"><span >正規表現</span></a></li>



	<li><a href="cookbook--string_example.html"><span >文字列</span></a></li>



	<li><a href="cookbook--sync_example.html"><span >同期機構/排他処理</span></a></li>



	<li><a href="cookbook--typecons_example.html"><span >型を作るユーティリティ</span></a></li>



	<li><a href="cookbook--uda_example.html"><span >UDA(User Defined Attribute)</span></a></li>



	<li><a href="cookbook--unittests_example.html"><span >単体テスト</span></a></li>





	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >subpkg</span></a><ul>
			

	<li><a href="cookbook-subpkg--subpkg.test.html"><span >サブパッケージの作り方</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >windows</span></a><ul>
			

	<li><a href="cookbook-windows--windows.basic.html"><span >Win32API</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >libdparse_usage</span></a><ul>
			

	<li><a href="cookbook-libdparse_usage--libdparse_usage.example.html"><span >libdparse</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >asdf_usage</span></a><ul>
			

	<li><a href="cookbook-asdf_usage--asdf_usage.example.html"><span >Asdfの使用例</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >vibed_usage</span></a><ul>
			

	<li><a href="cookbook-vibe-d_usage--vibed_usage.http.html"><span >HTTPサーバー</span></a></li>



	<li><a href="cookbook-vibe-d_usage--vibed_usage.https.html"><span >HTTPSサーバー</span></a></li>



	<li><a href="cookbook-vibe-d_usage--vibed_usage.rest.html"><span >RESTインターフェースの利用</span></a></li>



	<li><a href="cookbook-vibe-d_usage--vibed_usage.web.html"><span >Webインターフェースの利用</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >botan_usage</span></a><ul>
			

	<li><a href="cookbook-botan_usage--botan_usage.example.html"><span >Botanの使用例</span></a></li>


		</ul></li>
	




</ul>
</div>
            <div class="content">                
                <div class="quickindex" id="quickindex"></div>
                
                <h1><div class="ddoc_summary">文字列
</div></h1><div class="ddoc_description">文字列操作についてまとめます。

</div>
<div class="ddoc_section_nonstandard"><span class="ddoc_section_nonstandard_header">TODO:</span>
置換(replace)</div>
<div class="ddoc_examples"><span class="ddoc_examples_header">Examples:</span>
 文字列の連結
<div class="ddoc_blankline"></div>

事前に長さの分からない文字列を構築する場合、<span class="d_inlinecode donthyphenate notranslate">std.array</span> の <span class="d_inlinecode donthyphenate notranslate">appender</span> を使います。
<div class="ddoc_blankline"></div>

<span class="d_inlinecode donthyphenate notranslate">appender</span> : <a href="https://dlang.org/phobos/std_array.html#appender">https://dlang.org/phobos/std_array.html#appender</a>
<pre class="d_code notranslate"><span class="d_keyword">assert</span>(<span class="d_string">"ABC"</span> ~ <span class="d_string">"DEF"</span> == <span class="d_string">"ABCDEF"</span>);

<span class="d_comment">// 多くの文字を連結するときはappenderを使います
</span>
<span class="d_keyword">import</span> std.array : appender;

<span class="d_keyword">auto</span> buffer = appender!string;

buffer.put(<span class="d_string">"https://"</span>);
buffer.put(<span class="d_string">"github.com"</span>);
buffer.put(<span class="d_string">"/dlang"</span>);

<span class="d_keyword">assert</span>(buffer.data == <span class="d_string">"https://github.com/dlang"</span>);
</pre>
</div>
<div class="ddoc_examples"><span class="ddoc_examples_header">Examples:</span>
 書式化文字列
<div class="ddoc_blankline"></div>

<span class="d_inlinecode donthyphenate notranslate">std.format</span> の <span class="d_inlinecode donthyphenate notranslate">format</span> を使います。
<div class="ddoc_blankline"></div>

<a href="https://dlang.org/phobos/std_format.html#.format">https://dlang.org/phobos/std_format.html#.format</a>
<pre class="d_code notranslate"><span class="d_keyword">import</span> std.format : format;

<span class="d_keyword">int</span> n = 10;
<span class="d_keyword">float</span> f = 1.5;
string url = <span class="d_string">"https://github.com"</span>;

<span class="d_keyword">auto</span> text = format!<span class="d_string">"%d, %f, %s"</span>(n, f, url);

<span class="d_keyword">assert</span>(text == <span class="d_string">"10, 1.500000, https://github.com"</span>, text);
</pre>
</div>
<div class="ddoc_examples"><span class="ddoc_examples_header">Examples:</span>
 完全一致、辞書順での比較
<pre class="d_code notranslate"><span class="d_keyword">auto</span> text = <span class="d_string">"ABC"</span>;
<span class="d_keyword">assert</span>(text == <span class="d_string">"ABC"</span>);
<span class="d_keyword">assert</span>(text &lt; <span class="d_string">"abc"</span>);
</pre>
</div>
<div class="ddoc_examples"><span class="ddoc_examples_header">Examples:</span>
 大文字小文字を無視して比較
<div class="ddoc_blankline"></div>

<span class="d_inlinecode donthyphenate notranslate">std.uni</span> の <span class="d_inlinecode donthyphenate notranslate">icmp</span> を使います
<div class="ddoc_blankline"></div>

<span class="d_inlinecode donthyphenate notranslate">icmp</span> : <a href="https://dlang.org/phobos/std_uni.html#icmp">https://dlang.org/phobos/std_uni.html#icmp</a>
<pre class="d_code notranslate"><span class="d_keyword">import</span> std.uni;

<span class="d_keyword">auto</span> text = <span class="d_string">"ABC"</span>;
<span class="d_keyword">assert</span>(icmp(text, <span class="d_string">"abc"</span>) == 0);
<span class="d_keyword">assert</span>(icmp(text, <span class="d_string">"ab"</span>) == 1);
<span class="d_keyword">assert</span>(icmp(text, <span class="d_string">"abcd"</span>) == -1);

<span class="d_comment">// 使い方、戻り値のイメージ
</span><span class="d_comment">// "ABC" &gt; "ab"
</span><span class="d_comment">// "ABC" - "ab" &gt; 0
</span><span class="d_keyword">assert</span>(icmp(text, <span class="d_string">"abc"</span>) == 0);
<span class="d_keyword">assert</span>(icmp(text, <span class="d_string">"ab"</span>) &gt; 0);
<span class="d_keyword">assert</span>(icmp(text, <span class="d_string">"abcd"</span>) &lt; 0);
</pre>
</div>
<div class="ddoc_examples"><span class="ddoc_examples_header">Examples:</span>
 「で始まる」「で終わる」の例
<div class="ddoc_blankline"></div>

<span class="d_inlinecode donthyphenate notranslate">std.algorithm</span> の <span class="d_inlinecode donthyphenate notranslate">startsWith</span>, <span class="d_inlinecode donthyphenate notranslate">endsWith</span> を使います。
<div class="ddoc_blankline"></div>

<span class="d_inlinecode donthyphenate notranslate">startsWith</span> : <a href="https://dlang.org/phobos/std_algorithm_searching.html#.startsWith">https://dlang.org/phobos/std_algorithm_searching.html#.startsWith</a><br>
<span class="d_inlinecode donthyphenate notranslate">endsWith</span> : <a href="https://dlang.org/phobos/std_algorithm_searching.html#.endsWith">https://dlang.org/phobos/std_algorithm_searching.html#.endsWith</a>
<pre class="d_code notranslate"><span class="d_keyword">import</span> std.algorithm : startsWith, endsWith;

<span class="d_keyword">auto</span> text = <span class="d_string">"std.algorithm"</span>;

<span class="d_comment">// ～で始まる
</span><span class="d_keyword">assert</span>(startsWith(text, <span class="d_string">"std."</span>));
<span class="d_keyword">assert</span>(text.startsWith(<span class="d_string">"std."</span>));

<span class="d_comment">// ～で終わる
</span><span class="d_keyword">assert</span>(endsWith(text, <span class="d_string">".algorithm"</span>));
<span class="d_keyword">assert</span>(text.endsWith(<span class="d_string">".algorithm"</span>));
</pre>
</div>
<div class="ddoc_examples"><span class="ddoc_examples_header">Examples:</span>
 文字列が出現する位置を検索します。
<div class="ddoc_blankline"></div>

<span class="d_inlinecode donthyphenate notranslate">std.string</span> の <span class="d_inlinecode donthyphenate notranslate">indexOf</span> を使用します。
<div class="ddoc_blankline"></div>

<span class="d_inlinecode donthyphenate notranslate">indexOf</span> : <a href="https://dlang.org/phobos/std_string.html#.indexOf">https://dlang.org/phobos/std_string.html#.indexOf</a>
<pre class="d_code notranslate"><span class="d_keyword">import</span> std.string : indexOf;

<span class="d_keyword">auto</span> text = <span class="d_string">"std.algorithm.searching"</span>;

<span class="d_keyword">assert</span>(indexOf(text, <span class="d_string">"search"</span>) == 14);
<span class="d_keyword">assert</span>(text.indexOf(<span class="d_string">"search"</span>) == 14);

<span class="d_comment">// 大文字小文字を無視することもできます
</span><span class="d_comment">// std.typeconsからYesやNoをimportして使います
</span><span class="d_keyword">import</span> std.typecons : Yes, No;
<span class="d_keyword">import</span> std.string : CaseSensitive;

<span class="d_keyword">auto</span> url = <span class="d_string">"https://github.com/dlang/dmd"</span>;
<span class="d_keyword">assert</span>(url.indexOf(<span class="d_string">"GITHUB"</span>, No.CaseSensitive));
</pre>
</div>
<div class="ddoc_examples"><span class="ddoc_examples_header">Examples:</span>
 プログラムの整形文字列表現
<div class="ddoc_blankline"></div>

chompPrefixやstrip、outdent、などを使うことで、プログラム言語などの文字列表現をいい感じに記載することができます。
<div class="ddoc_blankline"></div>

ポイントはoutdentでインデントを解除することで、その前後にoutdentの入力にマッチするようにいい感じにchompPrefixで先頭の改行を削除したり、outdent結果を欲しい形に合うようにstripで先頭・末尾の改行を含む空白文字を削除するなどの前処理・後処理をします。
<div class="ddoc_blankline"></div>

パーサーを扱うようなプログラムなどで活躍します。
<div class="ddoc_blankline"></div>

<span class="d_inlinecode donthyphenate notranslate">outdent</span>: <a href="https://dlang.org/phobos/std_string.html#.outdent">https://dlang.org/phobos/std_string.html#.outdent</a><br>
<span class="d_inlinecode donthyphenate notranslate">chompPrefix</span>: <a href="https://dlang.org/phobos/std_string.html#.chompPrefix">https://dlang.org/phobos/std_string.html#.chompPrefix</a><br>
<span class="d_inlinecode donthyphenate notranslate">strip</span>: <a href="https://dlang.org/phobos/std_string.html#.strip">https://dlang.org/phobos/std_string.html#.strip</a>
<pre class="d_code notranslate"><span class="d_keyword">import</span> std.json;
<span class="d_keyword">import</span> std.string: outdent, chompPrefix, strip;
<span class="d_keyword">auto</span> jv = JSONValue(
    [
        <span class="d_string">"one"</span>: JSONValue(1),
        <span class="d_string">"two"</span>: JSONValue(
        [
            JSONValue(2),
            JSONValue(<span class="d_string">"弐"</span>)
        ])
    ]);

<span class="d_comment">// jvを文字列化したものが正しいことをassertすると
</span><span class="d_comment">// 入れ子になっていると以下のようになってしまい、1行だと見づらいですね。
</span><span class="d_keyword">assert</span>(jv.toString() == <span class="d_string">`{"one":1,"two":[2,"弐"]}`</span>);

<span class="d_comment">// まして、整形したものｎあぁああああああああああ！！！！！
</span><span class="d_keyword">assert</span>(jv.toPrettyString() == <span class="d_string">"{\n    \"one\": 1,\n    \"two\": [\n        2,\n        \"弐\"\n    ]\n}"</span>);

<span class="d_comment">// しかしながら、改行してしまうと以下のようにインデントが崩れてしまいます。
</span><span class="d_keyword">assert</span>(jv.toPrettyString() == <span class="d_string">`{
"one": 1,
"two": [
    2,
    "弐"
]
}`</span>);

<span class="d_comment">// これを解決するためには、以下のようにchompPrefix, outdentを使います。
</span><span class="d_keyword">assert</span>(jv.toPrettyString() == <span class="d_string">`
{
    "one": 1,
    "two": [
        2,
        "弐"
    ]
}`</span>.chompPrefix(<span class="d_string">"\n"</span>).outdent);

string fixLines(string s)
{
    <span class="d_keyword">version</span> (Windows)
    {
        <span class="d_keyword">import</span> std.array: replace;
        <span class="d_keyword">return</span> s.replace(<span class="d_string">"\r\n"</span>, <span class="d_string">"\n"</span>);
    }
    <span class="d_keyword">else</span> <span class="d_keyword">return</span> s;
}

<span class="d_comment">// 最初にoutdent、次にstripでもOK。(この場合最後の改行もなくなる)
</span><span class="d_comment">// ついでに以下の例は q{ ... } の文字列表現です。
</span><span class="d_comment">// また、fixLinesを通すのは、q{ ... }が改行コードをそのまま拾ってしまうため
</span><span class="d_comment">// gitの設定如何でCRLFだったりLFだったりする場合があるのを均すためです。
</span><span class="d_keyword">assert</span>(jv.toPrettyString() == fixLines(<span class="d_string">q{
    {
        "one": 1,
        "two": [
            2,
            "弐"
        ]
    }
}</span>.outdent.strip));
</pre>
</div>

                
            </div>
        </div>
        
        <script type="text/javascript">jQuery(document).ready(listanchors);</script>
        
        
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
     </body>
</html>