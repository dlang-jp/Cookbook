
<!DOCTYPE html>
<html>    <head>        <meta name="viewport" content="width=device-width,initial-scale=1">
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <link rel="stylesheet" type="text/css" href="css/proj_docs.css">
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script type="text/javascript" src="js/sidebar.js"></script>
        <script type="text/javascript" src="js/listanchors.js"></script>
        <title>file_example</title>
        
        
    </head>
    <body>        
        <div class="container">            
<div class="sidebar-underbar"></div>
<div class="sidebar">    <div class="head">        <h2>cookbook</h2>
        <p><span class="smallprint"><b>version:</b> ~master <span class="separator"><br></span>
            </span>
        </p>
        <p><a href="index.html">overview</a></p>
    </div>
    
    <ul>

	

	<li><a href="cookbook--array_example.html"><span >配列</span></a></li>



	<li><a href="cookbook--assoc_array_example.html"><span >連想配列</span></a></li>



	<li><a href="cookbook--concurrency_example.html"><span >並行処理</span></a></li>



	<li><a href="cookbook--container_example.html"><span >コンテナ</span></a></li>


	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >データ形式
		</span></a><ul><li><a href="
			cookbook--data.html"><span >overview</span></a></li>
			

	<li><a href="cookbook--data.base64_example.html"><span >Base64エンコード/デコード</span></a></li>



	<li><a href="cookbook--data.csv_example.html"><span >CSV操作</span></a></li>



	<li><a href="cookbook--data.json_example.html"><span >JSON操作</span></a></li>



	<li><a href="cookbook--data.zip_example.html"><span >ZIP操作</span></a></li>

</ul></li>
	
	





	<li><a href="cookbook--datetime_example.html"><span >時刻・日付</span></a></li>



	<li><a href="cookbook--exception_example.html"><span >例外</span></a></li>



	<li><a href="cookbook--file_example.html"><span >ファイルシステム</span></a></li>



	<li><a href="cookbook--getopt_example.html"><span >コマンドライン解析</span></a></li>



	<li><a href="cookbook--is_example.html"><span >is式</span></a></li>



	<li><a href="cookbook--meta_example.html"><span >メタプログラミング</span></a></li>



	<li><a href="cookbook--network_example.html"><span >ネットワーク(cURL)</span></a></li>



	<li><a href="cookbook--numeric_example.html"><span >数値計算</span></a></li>



	<li><a href="cookbook--opovl_excample.html"><span >演算子オーバーロード</span></a></li>



	<li><a href="cookbook--parallelism_example.html"><span >並列処理</span></a></li>



	<li><a href="cookbook--process_example.html"><span >プロセス</span></a></li>



	<li><a href="cookbook--random_example.html"><span >乱数</span></a></li>



	<li><a href="cookbook--range_example.html"><span >レンジ</span></a></li>



	<li><a href="cookbook--regex_example.html"><span >正規表現</span></a></li>



	<li><a href="cookbook--string_example.html"><span >文字列</span></a></li>



	<li><a href="cookbook--sync_example.html"><span >同期機構/排他処理</span></a></li>



	<li><a href="cookbook--typecons_example.html"><span >型を作るユーティリティ</span></a></li>



	<li><a href="cookbook--uda_example.html"><span >UDA(User Defined Attribute)</span></a></li>



	<li><a href="cookbook--unittests_example.html"><span >単体テスト</span></a></li>





	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >subpkg</span></a><ul>
			

	<li><a href="cookbook-subpkg--subpkg.test.html"><span >サブパッケージの作り方</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >windows</span></a><ul>
			

	<li><a href="cookbook-windows--windows.basic.html"><span >Win32API</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >libdparse_usage</span></a><ul>
			

	<li><a href="cookbook-libdparse_usage--libdparse_usage.example.html"><span >libdparse</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >asdf_usage</span></a><ul>
			

	<li><a href="cookbook-asdf_usage--asdf_usage.example.html"><span >Asdfの使用例</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >vibed_usage</span></a><ul>
			

	<li><a href="cookbook-vibe-d_usage--vibed_usage.http.html"><span >HTTPサーバー</span></a></li>



	<li><a href="cookbook-vibe-d_usage--vibed_usage.https.html"><span >HTTPSサーバー</span></a></li>



	<li><a href="cookbook-vibe-d_usage--vibed_usage.rest.html"><span >RESTインターフェースの利用</span></a></li>



	<li><a href="cookbook-vibe-d_usage--vibed_usage.web.html"><span >Webインターフェースの利用</span></a></li>


		</ul></li>
	







	
	
	
		<li class="expand-container open"><a class='expand-toggle' href="#"><span >botan_usage</span></a><ul>
			

	<li><a href="cookbook-botan_usage--botan_usage.example.html"><span >Botanの使用例</span></a></li>


		</ul></li>
	




</ul>
</div>
            <div class="content">                
                <div class="quickindex" id="quickindex"></div>
                
                <h1><div class="ddoc_summary">ファイルシステム
</div></h1><div class="ddoc_description">ファイル・パス操作についてまとめます。</div>
<div class="ddoc_examples"><span class="ddoc_examples_header">Examples:</span>
 テキストファイル操作の例です。
<pre class="d_code notranslate"><span class="d_comment">// 注: 以下の関数は他のmoduleの関数名と被っているためrename importしています。
</span><span class="d_keyword">import</span> std.file : fwrite = write, fremove = remove, fappend = append;
<span class="d_keyword">import</span> std.file;

<span class="d_comment">// 指定した文字列でテキストファイルを作成します。
</span>string textFile = <span class="d_string">"test.txt"</span>;
string content = <span class="d_string">"Hello, world!"</span>;
fwrite(textFile, content);

<span class="d_comment">// ファイルの存在を確認します。
</span><span class="d_keyword">assert</span>(textFile.exists);

<span class="d_comment">// ファイルの中身を読み込みます。
</span>string loadedContent = readText(textFile);
<span class="d_keyword">assert</span>(content == loadedContent);

<span class="d_comment">// ファイル名を変更します。
</span>string newTextFile = <span class="d_string">"test2.txt"</span>;
rename(textFile, newTextFile);
<span class="d_keyword">assert</span>(!textFile.exists);
<span class="d_keyword">assert</span>(newTextFile.exists);

<span class="d_comment">// ファイルに追記します。
</span>string additionalContent = <span class="d_string">"This is D world!!!!"</span>;
fappend(newTextFile, additionalContent);

<span class="d_comment">// ファイルの中身を再度確認します。
</span>string loadedContent2 = readText(newTextFile);
<span class="d_keyword">assert</span>(loadedContent2 == content ~ additionalContent);

<span class="d_comment">// ファイルを削除します。
</span>fremove(newTextFile);
<span class="d_keyword">assert</span>(!newTextFile.exists);
</pre>
</div>
<div class="ddoc_examples"><span class="ddoc_examples_header">Examples:</span>
 ディレクトリ操作の例です。
<pre class="d_code notranslate"><span class="d_comment">// 注: 以下の関数は他のmoduleの関数名と被っているためrenamed importしています。
</span><span class="d_keyword">import</span> std.file : fwrite = write;

<span class="d_keyword">import</span> std.algorithm : map, filter, sort;
<span class="d_keyword">import</span> std.array : array;
<span class="d_keyword">import</span> std.file;
<span class="d_keyword">import</span> std.path : buildPath;

<span class="d_comment">// ディレクトリを作成します。
</span>mkdir(<span class="d_string">"test"</span>);

<span class="d_comment">// ディレクトリを再帰的に作成します。
</span><span class="d_comment">//
</span><span class="d_comment">// パス操作を行うときはOS間の移植をあらかじめ想定するようにしましょう。
</span><span class="d_comment">// std.path.buildPathはOSに依存したパスセパレータを使用してくれます。
</span>mkdirRecurse(buildPath(<span class="d_string">"test"</span>, <span class="d_string">"foo"</span>, <span class="d_string">"bar"</span>));

<span class="d_comment">// 処理の最後にディレクトリを再帰的に削除します。
</span><span class="d_keyword">scope</span> (exit) rmdirRecurse(<span class="d_string">"test"</span>);

<span class="d_comment">// ファイルをディレクトリ内に作成します。
</span>fwrite(buildPath(<span class="d_string">"test"</span>, <span class="d_string">"a.txt"</span>), <span class="d_string">"This is File A."</span>);
fwrite(buildPath(<span class="d_string">"test"</span>, <span class="d_string">"b.txt"</span>), <span class="d_string">"I am File B."</span>);
fwrite(buildPath(<span class="d_string">"test"</span>, <span class="d_string">"foo"</span>, <span class="d_string">"c.txt"</span>), <span class="d_string">"My name is File C."</span>);
fwrite(buildPath(<span class="d_string">"test"</span>, <span class="d_string">"foo"</span>, <span class="d_string">"bar"</span>, <span class="d_string">"d.txt"</span>), <span class="d_string">"Please call me File D."</span>);

<span class="d_comment">// ディレクトリ内のファイルを列挙します。
</span>string[] paths;
<span class="d_keyword">foreach</span> (path; dirEntries(<span class="d_string">"test"</span>, SpanMode.breadth)) {
    paths ~= path.name;
}
sort(paths);
<span class="d_keyword">assert</span>(paths == [buildPath(<span class="d_string">"test"</span>, <span class="d_string">"a.txt"</span>),
                 buildPath(<span class="d_string">"test"</span>, <span class="d_string">"b.txt"</span>),
                 buildPath(<span class="d_string">"test"</span>, <span class="d_string">"foo"</span>),
                 buildPath(<span class="d_string">"test"</span>, <span class="d_string">"foo"</span>, <span class="d_string">"bar"</span>),
                 buildPath(<span class="d_string">"test"</span>, <span class="d_string">"foo"</span>, <span class="d_string">"bar"</span>, <span class="d_string">"d.txt"</span>),
                 buildPath(<span class="d_string">"test"</span>, <span class="d_string">"foo"</span>, <span class="d_string">"c.txt"</span>)]);
</pre>
</div>
<div class="ddoc_examples"><span class="ddoc_examples_header">Examples:</span>
 基本的なパスに操作の例です。
<div class="ddoc_blankline"></div>

<span class="d_inlinecode donthyphenate notranslate">baseName</span> 関数でファイル名の取得、<span class="d_inlinecode donthyphenate notranslate">dirName</span> 関数でディレクトリパスを取得します。
<pre class="d_code notranslate"><span class="d_keyword">import</span> std.path;

string filePath = buildPath(<span class="d_string">"test"</span>, <span class="d_string">"foo"</span>, <span class="d_string">"bar.txt"</span>);

<span class="d_comment">// ファイル名のみを抽出します。
</span>string fileName = filePath.baseName;
<span class="d_keyword">assert</span>(fileName == <span class="d_string">"bar.txt"</span>);

<span class="d_comment">// ディレクトリ名を抽出します。
</span>string fileDir = filePath.dirName;
<span class="d_keyword">assert</span>(fileDir == buildPath(<span class="d_string">"test"</span>, <span class="d_string">"foo"</span>));
</pre>
</div>
<div class="ddoc_examples"><span class="ddoc_examples_header">Examples:</span>
 ファイルパスの拡張子を操作する例です。
<div class="ddoc_blankline"></div>

取得、変更、取り除く、といった操作ができます。
<pre class="d_code notranslate"><span class="d_keyword">import</span> std.path : extension, setExtension, stripExtension;

<span class="d_comment">// extension 関数で拡張子を取得します。結果としてピリオド付きの拡張子が得られます。
</span><span class="d_comment">// ディレクトリパスなど、拡張子が無い場合は空文字が得られます。
</span><span class="d_keyword">assert</span>(extension(<span class="d_string">"/temp/hoge/test.txt"</span>) == <span class="d_string">".txt"</span>);
<span class="d_keyword">assert</span>(extension(<span class="d_string">"/data/2021-01-01/records.csv"</span>) == <span class="d_string">".csv"</span>);
<span class="d_keyword">assert</span>(extension(<span class="d_string">"/test/hoge/fuga"</span>) == <span class="d_string">""</span>);
<span class="d_comment">// 複数の拡張子がある場合、最後のピリオドより後ろの部分が得られます
</span><span class="d_keyword">assert</span>(extension(<span class="d_string">"/test/hoge/fuga.txt.old"</span>) == <span class="d_string">".old"</span>);

<span class="d_comment">// setExtension 関数で拡張子を変更したパスが得られます。
</span><span class="d_comment">// 設定する拡張子は、先頭にピリオドがあってもなくても構いません。
</span><span class="d_keyword">assert</span>(setExtension(<span class="d_string">"/temp/hoge/test.txt"</span>, <span class="d_string">".md"</span>) == <span class="d_string">"/temp/hoge/test.md"</span>);
<span class="d_keyword">assert</span>(setExtension(<span class="d_string">"/temp/hoge/test.txt"</span>, <span class="d_string">"md"</span>) == <span class="d_string">"/temp/hoge/test.md"</span>);
<span class="d_comment">// 複数の拡張子がある場合、最後のピリオドより後ろの部分が置き換えられます
</span><span class="d_keyword">assert</span>(setExtension(<span class="d_string">"/temp/hoge/test.txt.old"</span>, <span class="d_string">"md"</span>) == <span class="d_string">"/temp/hoge/test.txt.md"</span>);

<span class="d_comment">// stripExtension 関数で拡張子を取り除いたパスが得られます。
</span><span class="d_keyword">assert</span>(stripExtension(<span class="d_string">"/temp/hoge/test.txt"</span>) == <span class="d_string">"/temp/hoge/test"</span>);
<span class="d_keyword">assert</span>(stripExtension(<span class="d_string">"/data/2021-01-01/records.csv"</span>) == <span class="d_string">"/data/2021-01-01/records"</span>);
<span class="d_comment">// 複数の拡張子がある場合、最後のピリオドより後ろの部分が削除されます
</span><span class="d_keyword">assert</span>(stripExtension(<span class="d_string">"/data/2021-01-01/records.csv.bak"</span>) == <span class="d_string">"/data/2021-01-01/records.csv"</span>);
</pre>
</div>
<div class="ddoc_examples"><span class="ddoc_examples_header">Examples:</span>
 ファイル移動の例です。
<div class="ddoc_blankline"></div>

<span class="d_inlinecode donthyphenate notranslate">rename</span> を使い、ファイル名はそのままでディレクトリパスを変更することで移動が実現できます。
<pre class="d_code notranslate"><span class="d_keyword">import</span> std.file : rename, mkdir, rmdirRecurse, write;

<span class="d_comment">// 作業用に temp1 temp2 のディレクトリを作成し、temp1 にファイルを作成しておきます
</span>mkdir(<span class="d_string">"temp1"</span>);
<span class="d_keyword">scope</span> (exit) rmdirRecurse(<span class="d_string">"temp1"</span>);

mkdir(<span class="d_string">"temp2"</span>);
<span class="d_keyword">scope</span> (exit) rmdirRecurse(<span class="d_string">"temp2"</span>);

write(<span class="d_string">"temp1/test.txt"</span>, <span class="d_string">"TEST"</span>);

<span class="d_comment">// rename関数で名前を付け替えて移動します
</span>rename(<span class="d_string">"temp1/test.txt"</span>, <span class="d_string">"temp2/test.txt"</span>);

<span class="d_comment">// 確認
</span><span class="d_keyword">import</span> std.file : exists, readText;

<span class="d_keyword">assert</span>(!exists(<span class="d_string">"temp1/test.txt"</span>));
<span class="d_keyword">assert</span>(exists(<span class="d_string">"temp2/test.txt"</span>));
<span class="d_keyword">assert</span>(readText(<span class="d_string">"temp2/test.txt"</span>) == <span class="d_string">"TEST"</span>);
</pre>
</div>
<div class="ddoc_examples"><span class="ddoc_examples_header">Examples:</span>
 ディレクトリ内のファイル一覧のうち、パターンに合致するものだけを列挙する例です。
<div class="ddoc_blankline"></div>

<span class="d_inlinecode donthyphenate notranslate">dirEntries</span> に対して対象とするファイル名の glob パターンを指定します。
<div class="ddoc_blankline"></div>

See_Also: <a href="https://dlang.org/phobos/std_file.html#dirEntries">https://dlang.org/phobos/std_file.html#dirEntries</a>
See_Also: <a href="https://dlang.org/phobos/std_path.html#.globMatch">https://dlang.org/phobos/std_path.html#.globMatch</a>
<pre class="d_code notranslate"><span class="d_keyword">import</span> std.file : mkdir, rmdirRecurse, write;

mkdir(<span class="d_string">"temp"</span>);
<span class="d_keyword">scope</span> (exit) rmdirRecurse(<span class="d_string">"temp"</span>);

write(<span class="d_string">"temp/test1.txt"</span>, <span class="d_string">""</span>);
write(<span class="d_string">"temp/test2-1.txt"</span>, <span class="d_string">""</span>);
write(<span class="d_string">"temp/test2-2.txt"</span>, <span class="d_string">""</span>);
write(<span class="d_string">"temp/test2-3.txt"</span>, <span class="d_string">""</span>);
write(<span class="d_string">"temp/test3.txt"</span>, <span class="d_string">""</span>);

<span class="d_keyword">import</span> std.file : DirEntry, dirEntries, SpanMode;

<span class="d_comment">// dirEntriesの第2引数で、globと呼ばれるパターンを指定するとファイルの一覧を絞り込めます
</span><span class="d_comment">// * を指定すると任意の文字列にマッチします
</span>string[] testFiles;
<span class="d_keyword">foreach</span> (DirEntry entry; dirEntries(<span class="d_string">"temp"</span>, <span class="d_string">"test*.txt"</span>, SpanMode.shallow))
{
    testFiles ~= entry.name;
}

<span class="d_keyword">import</span> std.algorithm : sort;
<span class="d_keyword">import</span> std.path : buildPath;

sort(testFiles);
<span class="d_keyword">assert</span>(testFiles == [
    buildPath(<span class="d_string">"temp"</span>, <span class="d_string">"test1.txt"</span>),
    buildPath(<span class="d_string">"temp"</span>, <span class="d_string">"test2-1.txt"</span>),
    buildPath(<span class="d_string">"temp"</span>, <span class="d_string">"test2-2.txt"</span>),
    buildPath(<span class="d_string">"temp"</span>, <span class="d_string">"test2-3.txt"</span>),
    buildPath(<span class="d_string">"temp"</span>, <span class="d_string">"test3.txt"</span>),
]);

<span class="d_comment">// ? は任意の1文字にマッチします
</span><span class="d_comment">// [] で囲まれた文字はいずれか1文字にマッチします
</span>string[] test1or2;
<span class="d_keyword">foreach</span> (DirEntry entry; dirEntries(<span class="d_string">"temp"</span>, <span class="d_string">"test?-[12].txt"</span>, SpanMode.shallow))
{
    test1or2 ~= entry.name;
}

sort(test1or2);
<span class="d_keyword">assert</span>(test1or2 == [
    buildPath(<span class="d_string">"temp"</span>, <span class="d_string">"test2-1.txt"</span>),
    buildPath(<span class="d_string">"temp"</span>, <span class="d_string">"test2-2.txt"</span>),
]);

<span class="d_comment">// [!a] と指定した場合、a以外の1文字にマッチします
</span>string[] tempNot1;
<span class="d_keyword">foreach</span> (DirEntry entry; dirEntries(<span class="d_string">"temp"</span>, <span class="d_string">"test2-[!1].txt"</span>, SpanMode.shallow))
{
    tempNot1 ~= entry.name;
}

sort(tempNot1);
<span class="d_keyword">assert</span>(tempNot1 == [
    buildPath(<span class="d_string">"temp"</span>, <span class="d_string">"test2-2.txt"</span>),
    buildPath(<span class="d_string">"temp"</span>, <span class="d_string">"test2-3.txt"</span>),
]);

<span class="d_comment">// {A,B}とすると、A または B というパターンも表現できます
</span><span class="d_comment">// こちらは文字ではなく任意の文字列が指定できます
</span>string[] test1or3;
<span class="d_keyword">foreach</span> (DirEntry entry; dirEntries(<span class="d_string">"temp"</span>, <span class="d_string">"{test1,test3}.txt"</span>, SpanMode.shallow))
{
    test1or3 ~= entry.name;
}

sort(test1or3);
<span class="d_keyword">assert</span>(test1or3 == [
    buildPath(<span class="d_string">"temp"</span>, <span class="d_string">"test1.txt"</span>),
    buildPath(<span class="d_string">"temp"</span>, <span class="d_string">"test3.txt"</span>),
]);
</pre>
</div>

                
            </div>
        </div>
        
        <script type="text/javascript">jQuery(document).ready(listanchors);</script>
        
        
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
     </body>
</html>